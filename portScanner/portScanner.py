#!/usr/bin/python
#Castro Rendon Virgilio
import sys, socket

if len(sys.argv) not in (3,4):
	print "Use: ./portScanner.py IP startPort endPort"
	exit(0)

if __name__ == '__main__':
	try:
		portList = [sys.argv[2]] if len(sys.argv) == 3 else range(int(sys.argv[2]),int(sys.argv[3]))
		unique = True if len(portList) == 1 else False
		print "Iniciando escaneo a %s:\n" % sys.argv[1]
		for port in portList:
			s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
			if not s.connect_ex((sys.argv[1],int(port))):
				print "%s\t:\tListening" % port
			elif unique:
				print "%s\t:\tClosed" % port
			s.close()
	except:
		print "Unexpectd error"
