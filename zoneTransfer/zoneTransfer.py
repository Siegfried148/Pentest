#!/usr/bin/python
#Castro Rendon Virgilio 
import dns.query, dns.zone, dns.resolver, sys
if len(sys.argv) != 2:
	print "USAGE: zoneTransfer.py domain"
	exit(0)

for serv in dns.resolver.query(sys.argv[1],"NS"):
	try:
		print "\n\nDNS SERVER:\t"+str(serv)+"\n\n"
		zone = dns.zone.from_xfr(dns.query.xfr(str(serv), sys.argv[1]))
		for n in zone:
			print "\t\t"+zone[n].to_text(n)
	except:
		print "\t\tZone transfer is not available\n"
