#!/usr/bin/python
#Castro Rendon Virgilio
import subprocess, re, sys
if len(sys.argv) != 2:
	print "Indica la direccion IP a analizar"
	exit(0)
so = {"64":["FreeBSD","Linux","Android"],"128":["Windows"], "254":["Solaris"], "255":["OSx","iOS","Cisco IOS"]}
print "La direccion IP/host %s puede ser:" % sys.argv[1]
try:
	output,error = subprocess.Popen(("ping -c 5 %s" % sys.argv[1]),stdout=subprocess.PIPE, stderr=subprocess.PIPE,shell=True).communicate()
	ttl = re.search(r"ttl=([0-9]{2,3}) ",output)
	for s in so[ttl.group(1)]:
		print "\t"+s
except:
	print "\n\nERROR: No se pudo obtener el fingerprint\n\n"
